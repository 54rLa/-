<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>‰∏ÉÂ§ïÊÉÖ‰∫∫ÁØÄÂç°Áâá üíï</title>
    <style>
        /* Âü∫Êú¨Ê®£Âºè */
        * { margin:0; padding:0; box-sizing:border-box; }
        
        html, body {
            height: 100%;
            overflow: hidden;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #FFD1DC 0%, #FFE7F2 50%, #FFF0F5 100%);
            min-height: 100vh;
            overflow-x:hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .flex-center { display:flex; justify-content:center; align-items:center; }

        .container {
            width:90%;
            max-width:400px;
            perspective:1200px;
            max-height: 95vh;
        }

        .card {
            position:relative; width:100%;
            height: 100%;
            min-height: 350px;
            transform-style:preserve-3d;
            transition:transform .8s ease; cursor:pointer;
        }
        .card.opened { transform:rotateY(180deg); }

        .card-front, .card-back {
            position:absolute; width:100%; height:100%; backface-visibility:hidden;
            border-radius:20px; box-shadow:0 10px 30px rgba(0,0,0,0.3);
        }

        .card-front {
            background: linear-gradient(135deg, #FFC0CB, #FFB6C1);
            color:#fff; text-align:center; padding:20px;
        }
        .card-front.flex-center { flex-direction:column; }

        .card-back {
            background: linear-gradient(135deg, #FFEDF7, #FFF9FB);
            transform:rotateY(180deg);
            padding:30px;
            position:relative;
            overflow:hidden;
        }
        .card-back.flex-center { flex-direction:column; }

        .heart { font-size:4rem; margin-bottom:20px; animation:heartbeat 2s ease-in-out infinite; }
        @keyframes heartbeat { 0%,100%{transform:scale(1);} 50%{transform:scale(1.1);} }

        .card-title { font-size:1.8rem; margin-bottom:10px; font-weight:bold; }
        .card-subtitle { font-size:1rem; opacity:0.9; margin-bottom:20px; }
        .tap-hint { font-size:0.9rem; opacity:0.8; animation:pulse 2s ease-in-out infinite; }
        @keyframes pulse { 0%,100%{opacity:0.8;} 50%{opacity:1;} }

        .letter-container {
            position:relative; width:100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .envelope {
            position:absolute; width:85%; max-width:340px;
            height:160px;
            top:50%; left:50%; transform:translate(-50%,-50%);
            background:#fff; border-radius:10px; box-shadow:0 10px 25px rgba(0,0,0,0.18);
            z-index:6; cursor:pointer; transition: transform .35s cubic-bezier(.2,.8,.2,1);
            display:block; overflow:visible; transform-origin:center;
            perspective:800px;
        }

        .envelope .body {
            position:absolute; left:0; right:0; bottom:0; top:30px;
            background:#fff; border-radius:8px; z-index:1; overflow:hidden;
        }

        .envelope .flap {
            position:absolute; left:0; right:0; top:0;
            height:90px;
            z-index:4;
            display:block;
            transform-origin: 50% 0%;
            transition: transform 700ms cubic-bezier(.2,.9,.2,1), box-shadow 300ms ease;
            border-radius:10px 10px 0 0;
            background: linear-gradient(135deg, #FFC0CB, #F7CAC9);
            clip-path: polygon(0 0, 100% 0, 50% 100%);
            box-shadow: 0 8px 18px rgba(0,0,0,0.2);
            transform-style: preserve-3d;
        }

        .envelope.opened .flap {
            transform: rotateX(-160deg) translateZ(6px);
            box-shadow: 0 30px 40px rgba(0,0,0,0.25);
        }

        .letter {
            position:absolute; width:86%; left:50%;
            height:220px;
            top:50%;
            background:#fff; border-radius:8px; box-shadow:0 6px 20px rgba(0,0,0,0.25);
            padding:26px 20px; z-index:3; opacity:0;
            pointer-events:none;
            transform-origin: 50% 100%;
            transform: translate(-50%, 20px) rotate(-2deg);
        }

        @keyframes pullOut {
            0% { transform: translate(-50%, 20px) rotate(-2deg); opacity: 0; }
            55% { transform: translate(-50%, -60%) rotate(6deg); opacity: 1; }
            78% { transform: translate(-50%, -45%) rotate(-2deg); }
            100% { transform: translate(-50%, -50%) rotate(0deg); opacity: 1; }
        }

        @keyframes pushIn {
            0% { transform: translate(-50%, -50%) rotate(0deg); opacity: 1; }
            100% { transform: translate(-50%, 20px) rotate(-2deg); opacity: 0; }
        }

        .letter.visible { pointer-events: auto; animation: pullOut 800ms cubic-bezier(.22,.9,.3,1) forwards; z-index: 30; }
        .letter.hiding { pointer-events: none; animation: pushIn 450ms cubic-bezier(.2,.8,.2,1) forwards; z-index: 5; }
        .card-back.letter-opened .instruction { opacity:0; transform:translateY(8px); transition:opacity .3s, transform .3s; }
        .letter-content { color:#333; line-height:1.6; font-size:1rem; max-height:100%; overflow:auto; }
        .letter-title { color:#ff6b9d; font-size:1.3rem; margin-bottom:15px; text-align:center; font-weight:bold; }
        .signature { text-align:right; margin-top:20px; color:#ff6b9d; font-weight:bold; }
        .close-btn { position:absolute; top:8px; right:10px; background:none; border:none; font-size:1.6rem; color:#999; cursor:pointer; z-index:35; }
        .stars { position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:-1; }
        .star { position:absolute; color:rgba(255,255,255,0.8); font-size:1rem; animation:twinkle 3s ease-in-out infinite; }
        @keyframes twinkle { 0%,100%{opacity:0.3; transform:scale(1);} 50%{opacity:1; transform:scale(1.2);} }
        .instruction { position:absolute; bottom:20px; left:50%; transform:translateX(-50%); color: #FFB6C1; font-size:0.8rem; text-align:center; transition:opacity .5s ease, transform .5s ease; }
        .envelope:active { transform: translate(-50%,-50%) scale(.995); }

        /* ------------------ ÊãçÁ´ãÂæóÂãïÁï´Ê®£Âºè ------------------ */

        #camera-trigger {
            position: absolute;
            bottom: 15px;
            right: 15px;
            width: 50px;
            height: auto;
            cursor: pointer;
            z-index: 10;
            transition: transform 0.2s ease, opacity 0.3s ease;
        }
        #camera-trigger:hover { transform: scale(1.1); }
        .card-back.letter-opened #camera-trigger { opacity: 0; pointer-events: none; }

        #polaroid-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.75);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease, visibility 0.4s ease;
        }
        #polaroid-overlay.visible { opacity: 1; visibility: visible; }

        .polaroid-animation-container {
            position: relative;
            width: 250px;
            height: auto;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .camera-body {
            width: 100%;
            height: auto;
            display: block;
        }
        
        .photo-slot {
            position: absolute;
            top: 45px;
            left: 50%;
            transform: translateX(calc(-50% + 10px));
            width: 180px;
            height: 220px;
            overflow: hidden;
        }
        
        .photo-wrapper {
            width: 100%;
            height: 100%;
            transform: translateY(-100%);
        }
        
        .photo {
            position: relative; /* ‚òÖ Êñ∞Â¢ûÔºöÁÇ∫ÊñáÂ≠óÂÆö‰ΩçÂÅöÊ∫ñÂÇô */
            width: 100%;
            height: 100%;
            background: #fff;
            border-radius: 3px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            padding: 12px 12px 45px 12px;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .photo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0;
        }


        /* ‚òÖ Êñ∞Â¢ûÔºöÁÖßÁâá‰∏ãÊñπÊñáÂ≠óÁöÑÊ®£Âºè */
        .polaroid-caption {
            position: absolute;
            bottom: 12px;
            left: 0;
            right: 0;
            text-align: center;
            font-family: 'Ëæ∞ÂÆáËêΩÈõÅÈ´î', 'TW-Kai', 'Ê®ôÊ•∑È´î', 'DFKai-SB', 'ÂçéÊñáÊ•∑‰Ωì', 'STKaiti', 'Ê•∑‰Ωì', cursive, sans-serif; /* Ëæ∞ÂÆáËêΩÈõÅÈ´î */
            font-size: 1rem;
            color: #333;
            opacity: 0; /* ÂàùÂßãÈö±Ëóè */
        }
        
        @media (max-width: 500px) {
            .polaroid-caption {
                font-size: 0.8rem;
            }
        }


        #polaroid-overlay.visible .photo-wrapper {
            animation: printPhoto 2.5s cubic-bezier(0.6, 0, 0.4, 1) forwards;
            animation-delay: 0.5s;
        }

        #polaroid-overlay.visible .photo img {
            animation: developImage 2s ease-in forwards;
            animation-delay: 3s;
        }
        
        /* ‚òÖ Êñ∞Â¢ûÔºöÊñáÂ≠óÊ∑°ÂÖ•ÁöÑÂãïÁï´ */
        #polaroid-overlay.visible .polaroid-caption {
            animation: fadeInCaption 1s ease-in forwards;
            animation-delay: 3.5s; /* Âú®ÁÖßÁâáÈ°ØÂΩ±ÂæåÈñãÂßã */
        }

        @keyframes printPhoto {
            from { transform: translateY(-100%); }
            to { transform: translateY(0); }
        }

        @keyframes developImage {
            from { opacity: 0; filter: sepia(1) contrast(0.8); }
            to { opacity: 1; filter: sepia(0) contrast(1); }
        }

        /* ‚òÖ Êñ∞Â¢ûÔºöÊñáÂ≠óÊ∑°ÂÖ•ÁöÑ Keyframes */
        @keyframes fadeInCaption {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .close-polaroid-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            font-size: 2.5rem;
            color: #fff;
            cursor: pointer;
            text-shadow: 0 0 5px rgba(0,0,0,0.5);
        }

        /* ÈüøÊáâÂºèË®≠Ë®à (ÊâãÊ©ü) */
        @media (max-width: 500px) {
            .container { max-width: 98vw; max-height: 90vh; }
            .card { height: 65vh; min-height: 300px; }
            .card-back { padding: 15px; }
            .envelope { width: 90%; height: 130px; max-height: 180px; }
            .envelope .flap { height: 60px; }
            .letter { width: 92%; height: 250px; max-height: 250px; top: 50%; transform: translate(-50%, 20px) rotate(-2deg); padding: 12px 10px; }
            .heart { font-size:2rem; }
            .card-title { font-size:1.1rem; }
            .card-subtitle { font-size:0.85rem; }
            .tap-hint { font-size:0.8rem; }
            .letter-title { font-size:1rem; margin-bottom: 5px; }
            .letter-content { font-size:0.85rem; line-height: 1.4; }
            .signature { font-size:0.8rem; margin-top: 8px; }
            .close-btn { font-size:1.8rem; top:2px; right:4px; }
            .instruction { bottom: 8px; font-size:0.7rem; padding:0 5px; }

            #camera-trigger { width: 40px; bottom: 10px; right: 10px; }

            .polaroid-animation-container { width: 200px; }
            
            .photo-slot {
                top: 140px;
                left: 50%;
                transform: translateX(calc(-50% + 5px));
                width: 144px;
                height: 176px;
            }
        }
    </style>
</head>
<body>
    <div class="stars" id="stars"></div>

    <div class="container">
        <div class="card" id="card">
            <div class="card-front flex-center">
                <div class="heart">üíï</div>
                <div class="card-title">‰∏ÉÂ§ïÊÉÖ‰∫∫ÁØÄ</div>
                <div class="card-subtitle">Áµ¶ÊàëÊúÄÊÑõÁöÑ‰Ω†</div>
                <div class="tap-hint">ÈªûÊìäÂç°ÁâáÊâìÈñã</div>
            </div>

            <div class="card-back flex-center">
                <div class="letter-container">
                    <div class="envelope" id="envelope" aria-label="‰ø°Â∞ÅÔºåÈªûÊìäÊâìÈñã" aria-expanded="false">
                        <div class="flap" id="flap" aria-hidden="true"></div>
                        <div class="body"></div>
                    </div>
                    <div class="letter" id="letter" role="document" aria-hidden="true">
                        <button class="close-btn" id="closeBtn" aria-label="ÈóúÈñâ‰ø°‰ª∂">√ó</button>
                        <article class="letter-content">
                            <div class="letter-title">ÂèØÊÑõÁöÑÂ∞èÂØ∂Ë≤ù üíñ</div>
                            <p>Âú®ÈÄôÂÄãÁâπÂà•ÁöÑ‰∏ÉÂ§ïÊÉÖ‰∫∫ÁØÄÔºåÊàëÊÉ≥ÂëäË®¥‰Ω†
                            <br>
                            <p>ÈõñÁÑ∂‰πãÂâçÂõ†ÁÇ∫ÊàëÁöÑ‰∏çÊàêÁÜüËÄåËÆì‰Ω†Ê£Æ77
                            <br>
                            <p>‰ΩÜÁ∂ìÈÅé‰∫ÜÈÄôÈ∫º‰πÖÁöÑÊôÇÈñìÊàëÂ∑≤Á∂ìupdateÂà∞2.0‰∫Ü
                            <br>
                            <p>ÁµïÂ∞ç‰∏çÊúÉÂÜçÂÉè‰ª•Ââç‰∏ÄÊ®£ÊÉπÂ∞èÂØ∂Ë≤ù‰∏çÈñãÂøÉ
                            <br>
                            <p>ÊàëÂÄëÈÇÑË¶ÅÂéªÂæàÂ§öÂú∞Êñπ ÂÅöÂæàÂ§ö‰∫ãÊÉÖ(Âπ´Â∞èÂØ∂Ë≤ùÊèíÂ∞æÂ∑¥)
							<br>
							<p>Ê≠ê‰ΩÜÊàëÂèØËÉΩË∂ÖÁ¥öÁõ¥Áî∑ÊâÄ‰ª•Â∞èÂØ∂Ë≤ù‰ª•Âæå‰πüË¶ÅÂ§öÂ§öÈ´îË´íÊàë
							<br>
							<p>ÂèØ‰ª•ÁöÑË©±È∫ªÁÖ©Â∞èÂØ∂Ë≤ùÊèêÈÜíÊàëÂìàÂìàÂìà
							<br>
							<p>Â∞èÂØ∂Ë≤ùÁöÑÁ¶ÆÁâ©ÈõñÁÑ∂Ê≤íËæ¶Ê≥ïÂú®‰∏ÉÂ§ïÈÄôÂ§©ÈÄÅÁµ¶Â∞èÂØ∂Ë≤ùQQ
							<br>
							<p>‰ΩÜÊàë‰∏ÄÂÆöÊúÉÈÄÅÂ∞èÂØ∂Ë≤ù„ÑâÔºÅÔºÅÔºÅ
							<br>
							</p>
                            <div class="signature">Ê∞∏ÈÅ†ÊÑõ‰Ω†ÁöÑÔ∏èÂ∞èÂòüÂòü</div>
                        </article>
                    </div>
                </div>
                <div class="instruction">ÈªûÊìä‰ø°Â∞ÅÂèñÂá∫Âç°Áâá</div>
                <img src="cam.jpg" alt="ÊãçÁ´ãÂæóÁõ∏Ê©ü" id="camera-trigger">
            </div>
        </div>
    </div>

    <div id="polaroid-overlay" role="dialog" aria-modal="true" aria-hidden="true">
        <button class="close-polaroid-btn" aria-label="ÈóúÈñâÁÖßÁâá">√ó</button>
        <div class="polaroid-animation-container">
            <img src="cam.jpg" alt="ÊãçÁ´ãÂæóÁõ∏Ê©ü" class="camera-body">
            <div class="photo-slot">
                <div class="photo-wrapper">
                    <div class="photo">
                        <img src="img1.jpg" alt="‰∏ÉÂ§ïÊÉÖ‰∫∫ÁØÄÈ©öÂñúÁÖßÁâá">
                        <!-- ‚òÖ Êñ∞Â¢ûÁöÑÊñáÂ≠óÊ®ôÁ±§ -->
                        <p class="polaroid-caption">Ê∞∏ÈÅ†ÊÑõ‰Ω†</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // JavaScript ÈÉ®ÂàÜÁÑ°ÈúÄ‰øÆÊîπ
        function createStars() {
            const starsContainer = document.getElementById('stars');
            if (!starsContainer) return;
            for (let i = 0; i < 50; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.innerHTML = '‚ú®';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.fontSize = (8 + Math.random() * 14) + 'px';
                star.style.animationDelay = Math.random() * 3 + 's';
                starsContainer.appendChild(star);
            }
        }
        createStars();

        const card = document.getElementById('card');
        const cardBack = document.querySelector('.card-back');
        const envelope = document.getElementById('envelope');
        const flap = document.getElementById('flap');
        const letter = document.getElementById('letter');
        const closeBtn = document.getElementById('closeBtn');

        let cardOpened = false;
        let letterVisible = false;

        const CARD_FLIP_DELAY = 500;
        const FLAP_TO_LETTER_DELAY = 380;
        const LETTER_PUSHIN_DELAY = 460;
        const LETTER_HIDING_DELAY = 250;

        card.addEventListener('click', function(e) {
            if (!cardOpened && !e.target.closest('.envelope') && !e.target.closest('.letter') && e.target.id !== 'camera-trigger') {
                cardOpened = true;
                card.classList.add('opened');
            }
        });

        envelope.addEventListener('click', function(e) {
            e.stopPropagation();
            if (!cardOpened) {
                cardOpened = true;
                card.classList.add('opened');
                setTimeout(() => openEnvelopeAndPull(), CARD_FLIP_DELAY);
                return;
            }
            openEnvelopeAndPull();
        });

        function openEnvelopeAndPull() {
            if (letterVisible) return;
            letterVisible = true;
            envelope.classList.add('opened');
            flap.setAttribute('aria-hidden','false');
            envelope.setAttribute('aria-expanded','true');
            setTimeout(() => {
                cardBack.classList.add('letter-opened');
                letter.classList.remove('hiding');
                letter.classList.add('visible');
                letter.setAttribute('aria-hidden','false');
            }, FLAP_TO_LETTER_DELAY);
        }

        function closeLetterAndEnvelope() {
            if (!letterVisible) return;
            letter.classList.remove('visible');
            letter.classList.add('hiding');
            letter.setAttribute('aria-hidden','true');
            cardBack.classList.remove('letter-opened');
            setTimeout(() => {
                envelope.classList.remove('opened');
                envelope.setAttribute('aria-expanded','false');
                setTimeout(() => {
                    letter.classList.remove('hiding');
                    letterVisible = false;
                }, LETTER_HIDING_DELAY);
            }, LETTER_PUSHIN_DELAY);
        }

        closeBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            closeLetterAndEnvelope();
        });

        letter.addEventListener('click', function(e) {
            e.stopPropagation();
        });

        document.querySelector('.card-back').addEventListener('click', function(e) {
            if (letterVisible && !e.target.closest('.letter') && !e.target.closest('.envelope')) {
                closeLetterAndEnvelope();
            }
        });

        const cameraTrigger = document.getElementById('camera-trigger');
        const polaroidOverlay = document.getElementById('polaroid-overlay');
        const closePolaroidBtn = document.querySelector('.close-polaroid-btn');

        function showPolaroidAnimation() {
            if (!letterVisible) {
                polaroidOverlay.classList.add('visible');
                polaroidOverlay.setAttribute('aria-hidden', 'false');
            }
        }

        function hidePolaroidAnimation() {
            polaroidOverlay.classList.remove('visible');
            polaroidOverlay.setAttribute('aria-hidden', 'true');
        }

        cameraTrigger.addEventListener('click', function(e) {
            e.stopPropagation();
            showPolaroidAnimation();
        });

        closePolaroidBtn.addEventListener('click', hidePolaroidAnimation);

        polaroidOverlay.addEventListener('click', function(e) {
            if (e.target === polaroidOverlay) {
                hidePolaroidAnimation();
            }
        });
        
        window.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                if (letterVisible) {
                    closeLetterAndEnvelope();
                } else if (polaroidOverlay.classList.contains('visible')) {
                    hidePolaroidAnimation();
                }
            }
        });
    </script>
</body>
</html>